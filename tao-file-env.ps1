# Script PowerShell ƒë·ªÉ t·∫°o file .env

Write-Host "=== T·∫†O FILE .ENV CHO OAUTH2 ===" -ForegroundColor Cyan
Write-Host ""

# Ki·ªÉm tra file .env ƒë√£ t·ªìn t·∫°i ch∆∞a
if (Test-Path .env) {
    Write-Host "‚ö†Ô∏è  File .env ƒë√£ t·ªìn t·∫°i!" -ForegroundColor Yellow
    $overwrite = Read-Host "B·∫°n c√≥ mu·ªën ghi ƒë√® kh√¥ng? (y/n)"
    if ($overwrite -ne "y" -and $overwrite -ne "Y") {
        Write-Host "ƒê√£ h·ªßy." -ForegroundColor Red
        exit
    }
}

Write-Host ""
Write-Host "Nh·∫≠p th√¥ng tin OAuth2 t·ª´ Google Cloud Console:" -ForegroundColor Green
Write-Host ""

# Nh·∫≠p Client ID
$clientId = Read-Host "Google Client ID (d·∫°ng: xxxxx.apps.googleusercontent.com)"
if ([string]::IsNullOrWhiteSpace($clientId)) {
    Write-Host "‚ùå Client ID kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!" -ForegroundColor Red
    exit
}

# Nh·∫≠p Client Secret
$clientSecret = Read-Host "Google Client Secret (d·∫°ng: GOCSPX-xxxxx)"
if ([string]::IsNullOrWhiteSpace($clientSecret)) {
    Write-Host "‚ùå Client Secret kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!" -ForegroundColor Red
    exit
}

# Callback URL
$callbackUrl = Read-Host "Callback URL (Enter ƒë·ªÉ d√πng m·∫∑c ƒë·ªãnh)"
if ([string]::IsNullOrWhiteSpace($callbackUrl)) {
    $callbackUrl = "http://localhost:5000/api/auth/google/callback"
}

# T·∫°o n·ªôi dung file .env
$envContent = @"
# Google OAuth2 Configuration
# Generated by tao-file-env.ps1

GOOGLE_CLIENT_ID=$clientId
GOOGLE_CLIENT_SECRET=$clientSecret
GOOGLE_CALLBACK_URL=$callbackUrl
"@

# Ghi file
try {
    $envContent | Out-File -FilePath .env -Encoding utf8 -NoNewline
    Write-Host ""
    Write-Host "‚úÖ ƒê√£ t·∫°o file .env th√†nh c√¥ng!" -ForegroundColor Green
    Write-Host ""
    Write-Host "üìù N·ªôi dung file .env:" -ForegroundColor Cyan
    Write-Host "‚îÄ" * 50
    Write-Host $envContent
    Write-Host "‚îÄ" * 50
    Write-Host ""
    Write-Host "‚ö†Ô∏è  L∆ØU √ù:" -ForegroundColor Yellow
    Write-Host "   - File .env ch·ª©a th√¥ng tin nh·∫°y c·∫£m, KH√îNG commit v√†o Git"
    Write-Host "   - H√£y restart server ƒë·ªÉ √°p d·ª•ng c·∫•u h√¨nh m·ªõi"
    Write-Host "   - Ch·∫°y: node server.js"
    Write-Host ""
} catch {
    Write-Host "‚ùå L·ªói khi t·∫°o file .env: $_" -ForegroundColor Red
}


